<?xml version="1.0" encoding="UTF-8"?>
<server description="Default Server">

    <!-- Enable features -->
    <featureManager>
        <feature>javaee-8.0</feature>
        <feature>microProfile-3.0</feature>
        <feature>adminCenter-1.0</feature>
        <feature>appSecurity-2.0</feature>
        <feature>openidConnectClient-1.0</feature>
        <feature>transportSecurity-1.0</feature>
    </featureManager>

    <!-- OIDC RP config -->
    <openidConnectClient id="oidcBridge" 
        clientId="8iaBJqUvplclnF4dRzViY5nHpZ6rkWOD"
        clientSecret="---"
        discoveryEndpointUrl="https://jv-aia.au.auth0.com/.well-known/openid-configuration" 
        signatureAlgorithm="RS256" 
        disableLtpaCookie="false" 
        allowDefaultSsoCookieName="true" />

    <!-- BA config -->
    <basicRegistry id="basic">
        <user name="admin" password="admin" />
        <user name="user1" password="user1" />
        <user name="user2" password="user2" />
        <group name="users">
            <member name="user1" />
            <member name="user2" />
        </group>
    </basicRegistry>

    <!-- Role Mapping -->
    <administrator-role>
        <user>admin</user>
    </administrator-role>

    <!-- To allow access to this server from a remote client host="*" has been added to the following element -->
    <httpEndpoint id="defaultHttpEndpoint" 
        host="*" 
        httpPort="9080" 
        httpsPort="9443" />

    <!-- Automatically expand WAR files and EAR files -->
    <applicationManager autoExpand="true" />
    
    <!-- Trust Store Config-->
    <keyStore id="defaultKeyStore" 
        password="Mju76yhn" 
        location="/media/jv-trust.p12" 
        type="PKCS12" />

    <!-- LTPA Config-->
    <ltpa keysFileName="/media/jv-ltpa.keys" keysPassword="Mju76yhn" expiration="1200" />

    <!-- General Web Sec Config -->
    <webAppSecurity singleSignonEnabled="true" 
        ssoDomainNames="app1.com" 
        allowFailOverToBasicAuth="true"
        ssoRequiresSSL="false" />

    <!-- Install Default App -->
    <application id="DefaultApplication"
        context-root="snoop" 
        location="${server.config.dir}/apps/DefaultApplication.ear" 
        name="DefaultApplication" 
        type="ear">
        <application-bnd>
            <security-role name="All Role">
                <special-subject type="ALL_AUTHENTICATED_USERS" />
            </security-role>
        </application-bnd>
    </application>

</server>